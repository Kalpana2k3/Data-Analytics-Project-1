DOWNLOADING DATASET :
#import libraries
#!pip install kaggle
import kaggle

#Download datasets from kaggle
!kaggle datasets download ankitbansal06/"____" -f orders.csv --force

#extract file from zip file
import zipfile
zip_ref = zipfile.ZipFile('orders.csv.zip')
zip_ref.extractall()
zip_ref.close()

IMPORTING DATA :
#read data from file and handle null values
import pandas as pd
df = pd.read_csv('orders.csv',na_values=['Not Available','unknown']) #making␣
↪them as nan values
df['Ship Mode'].unique()

DATA CLEANING :
#rename column names. make them lower case and replace space with underscore

#df.rename(columns={'Order Id':'order_id', 'City:city'}) #time consuming␣
↪because we need to specify every columns one by one

#another method
df.columns = df.columns.str.lower() #converts everything into lower case
df.columns = df.columns.str.replace(' ','_')
df.head(6)

#derive new columns discount, sale price and profit
#creating new column named 'discount'
df['discount'] = df['list_price']*df['discount_percent']*.01 #/100 & *.01 are␣
↪same thing
df['sale_price'] = df['list_price'] - df['discount']
df['profit'] = df['sale_price'] - df['cost_price']
df

#convert order date from object datatype to datetime datatype
#df.dtypes
df['order_date'] = pd.to_datetime(df['order_date'],format="%Y-%m-%d") #Y mut be␣
↪capital!!
df.dtypes

#drop unwanted columns (cost price, list price, discount percent)
df.drop(columns=['cost_price','list_price','discount_percent'],inplace=True)
df

LOADING DATA TO SERVER
#pip install sqlalchemy
# establishing connection
import sqlalchemy as sal
engine = sal.create_engine('xxxxx')
conn = engine.connect()

#Loading data into server using append option
#df.to_sql('df_orders', con = conn, index = False, if_exists = 'replace')
"""so if we use "replace" option, Pandas will create a DB with the
highest size possible. That will take MORE SPACE in the server.
So its not the best option to do."""

# Instead, we can use "APPEND" option.
df.to_sql('df_orders', con = conn, index = False, if_exists = 'append')




